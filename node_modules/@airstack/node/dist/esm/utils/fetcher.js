import { config } from '../config';
import { AIRSTACK_ENDPOINT } from '../constants';
import fetch from './fetch';
export async function _fetch(query, variables) {
    if (!config.authKey) {
        return [null, Error('No API key provided')];
    }
    try {
        const res = await fetch(AIRSTACK_ENDPOINT, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                Authorization: config.authKey,
            },
            body: JSON.stringify({
                query,
                variables,
            }),
        });
        const json = (await res.json());
        const data = json === null || json === void 0 ? void 0 : json.data;
        let error = null;
        if (json.errors || json.error) {
            error = json.errors || json.error;
        }
        return [data, error];
    }
    catch (_error) {
        const error = typeof _error === 'string'
            ? _error
            : _error === null || _error === void 0 ? void 0 : _error.message;
        return [null, error || 'Unable to fetch data'];
    }
}
export async function fetchGql(query, variables) {
    return _fetch(query, variables);
}
//# sourceMappingURL=fetcher.js.map