"use strict";
exports.__esModule = true;
var https_1 = require("https");
function fetch(url, options) {
    return new Promise(function (resolve, reject) {
        var req = (0, https_1.request)(url, options, function (res) {
            var data = [];
            res.on('data', function (chunk) {
                data.push(chunk);
            });
            res.on('end', function () {
                var dataObject = null;
                var error = null;
                var dataString = Buffer.concat(data).toString();
                try {
                    dataObject = JSON.parse(dataString);
                }
                catch (_a) {
                    error = dataString;
                }
                resolve({
                    json: function () { return (error ? { error: error } : dataObject); }
                });
            });
        }).on('error', function (error) {
            var errorMessage = typeof error === 'string' ? error : error.message;
            reject(errorMessage || 'Something went wrong');
        });
        req.write(options.body);
        req.end();
    });
}
exports["default"] = fetch;
//# sourceMappingURL=fetch.js.map